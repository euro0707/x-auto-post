# X Auto Post System (GAS)

Google Sheetsで管理された投稿内容を、指定された日時に自動でX（旧Twitter）へ投稿するGoogle Apps Scriptシステムです。

## 機能

- **予約投稿**: スプレッドシートで指定した日時に自動投稿。
- **画像添付**:
  - Google Driveの画像URL
  - セル内に直接挿入・貼り付けされた画像（CellImage / OverGridImage）
- **スレッド投稿**: 複数のツイートをツリー形式で連続投稿。
- **エンゲージメント計測**: 投稿後の「いいね」「リツイート」数などを自動取得（要API設定）。
- **文字数カウント**: Xの仕様（全角140文字、URL短縮など）に合わせたカウント機能。

## セットアップ

### 1. Google Sheetの用意

`sheet` という名前のシートを作成し、以下の列構成にします。

| 列 | 項目名 | 説明 |
|---|---|---|
| A | 投稿本文 | ツイートの内容（必須） |
| B | 文字数 | 自動計算（X仕様準拠） |
| C | 画像 | セル内画像 or Google Drive URL（最大4枚） |
| D | noteリンク | 投稿後にリプライとして投稿されるURL（任意） |
| E | 日にち | 投稿予定日（シリアル値） |
| F | 時 | 投稿予定時刻の「時」（0-23） |
| G | 分 | 投稿予定時刻の「分」（0-59） |
| H | 投稿URL | 投稿完了後に自動記録されるツイートURL |
| I | スレッドグループID | 同じIDを持つ行を連続投稿（任意） |
| J | ステータス | pending/posting/posted/failed |
| K | いいね数 | エンゲージメント指標（自動更新） |
| L | リポスト数 | エンゲージメント指標（自動更新） |
| M | 返信数 | エンゲージメント指標（自動更新） |
| N | 引用数 | エンゲージメント指標（自動更新） |
| O | インプレッション数 | 有料プラン専用（自動更新） |
| P | ブックマーク数 | 有料プラン専用（自動更新） |
| Q | 最終更新日時 | エンゲージメント更新日時 |

### 2. スクリプトプロパティの設定

Apps Scriptのエディタで「プロジェクトの設定 > スクリプトプロパティ」を開き、以下を設定します。

- `X_API_KEY`
- `X_API_SECRET`
- `X_ACCESS_TOKEN`
- `X_ACCESS_TOKEN_SECRET`

### 3. トリガーの設定

- `postNextScheduledToX`: 1分〜1時間おき（投稿頻度に合わせて）
- `dailyEngagementUpdate`: 1日1回（例: 朝9時）

## 画像の投稿について

セルに画像を挿入する方法は以下のどちらでも対応しています。
- **セル内に画像を挿入**: 「挿入 > 画像 > セル内に画像を挿入」
- **セル上に画像を配置**: 「挿入 > 画像 > セル上に画像を配置」

## ライセンス

MIT
